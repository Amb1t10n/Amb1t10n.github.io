---
title: C语言指针
date: 2020-01-14 09:58:48
tags: study
---
对于很多人来说，指针这块东西确实让人难懂  
但是他的名字很形象地表现他的性质  
他就是一个指向某块数据的类型，就类似于一种快捷方式  
你可以用指针迅速访问你要代表的那个变量  
利用指针对原来那个变量做出各种操作 
---  
## 指针类型

指针也是一种数据类型，他的值是一串16进制的数，表示的是地址，也就是在内存中，所代表的数据的位置，  
定义指针的时候也是那几种  
比如`char*`、`int*`、`double*`等等，也可以是指向指针的指针，比如 `int**` ，指向指针的指针的指针的......<del>套娃</del>。但是他比常用的数据类型还多了一种`void*`也就是可以指向任何类型的指针  
但是这并不代表`ElementType*`是一种类型，`*`只是一种标记，在哪个变量前面就代表哪个就是指针，并没有`int *`这种类型。  
## 指针的定义
指针定义的时候，是通过`*`来区别是指针还是普通的变量。  
使用时通过 `*` 来访问所代表的变量的值  
	
	int *p,q;
在这句中，只有p是指针，而q是普通的`int`型的变量  
`int`中存储的变量是整数，`double`中是双精度浮点数，那么指针呢？  
**指针中存储的是地址，所以赋值的时候，是用`&`取址来赋值**
    
	#include <stdio.h>
	int main(){
		int n=5;
		int *a=&n;
		int *p=0;
		int *q=2;
        printf("%x %p\n",a,&n);
		printf("%d %d",n,*a);
		return 0;
	}
![](http://a1.qpic.cn/psc?/V10sEcVl2YNGQb/dc.CEbKkDpD9Z7TwDzRx5.m.JSOnnu93NcvysMPqpp524FgNmVgMlM5ddlqgO.AAfbMGSv9gqAdpdANa43RTCg!!/c&ek=1&kp=1&pt=0&bo=qQOjAAAAAAADFzs!&tl=1&vuin=1632660232&tm=1579136400&sce=60-2-2&rf=viewer_4)
上图即为此段代码的运行结果  
我们不难发现，`a`的值是和`n`的地址是一样的，并且`n`和`*a`的值也相同。  
所以在定义的时候可以将一个指针的值赋值给另一个  
就比如`int *new=a`,在此时，`a`中的地址赋值给`new`,	`new`就也指向了`n`
在这块代码中，定义了一个指针 `a` ，并且对`a`进行赋值，也就是`n`的地址，`&`在这则是取址符号，即取出`n`的地址，使得`a`指向`n`  
在下一行的`printf`中，由于`*`在`a`前，把`a`指向的变量取出，所以两个值是相同的  
但是`int *p=0;`与`int *q=2`这两句，将整数赋给指针，那么在这的整数，就是一句无报错一句有报错，这是怎样一回事呢？  
在这两句中，`0` `2`都被当作是地址，但`0`可以理解为一种特殊的地址，对指针进行初始化的时候常常用到`0`或者是`NULL`，此二者是相同的，在指针定义后没有被初始化时，我们不知道它指向何处，所以称它为“野指针”，所以赋值`0`是不会有“王宁”的，但是`2`的地址是一个不可写的位置所以在这句中会有warning

## 指针的应用  
众所周知<del>（学了C的人都知道）</del>，C的函数中，`return`只能返回一个值，而想要在函数中返回两个值甚至多个值，就需要通过函数传入所要改变的值的地址，在函数内部进行操作，从而改变函数外这个变量的值，进而达到返回多个值的目的   
    
    #include <stdio.h>
    int  find(int a,int b,int *min);
    int main(){
        int a=5,b=6;
        int max,min;
        max=find(a,b,&min);
        printf("%d %d",max,min);
        return 0;
    }
    int  find(int a,int b,int *min){
        return a>b?(*min=b,a):(*min=a,b);
    }
我们通过这样的一个函数来找出两个数中的最大值和最小值，当然不可否认的是，这样做确实比较蠢，但是个人觉得这是一个很好的例子，来说明通过指针来返回多个数据。在后期甚至会遇到需要将一个链表拆分成两个链表，并且在main函数中输出，此时则需要函数返回一个，再对原来的链表操作从而达到返回两个链表的目的  
还有我们想要通过函数去交换两个数的值，比如这样
    
    void swap(int a,int b){
        int temp=a;
        a=b;
        b=temp;
    }
  
  
## 指针与数组
**数组**是在内存中一连串的数据空间，通过`[]`来访问对应位置上的元素，**指针**则是指向空间中某个位置。  
在c89的时候，不能用未知量来定义数组，`int a[n]`这种行为是非法的，而在那个时候就是用  
  
    int *a=malloc(sizeof(int)*n);
可以使用这样的方式来申请一块连续的内存空间，从而达到存储的目的。  
在函数中，传入数组时，数组会退化成指针，而数组的头就是`a[0]`的地址，即`a==&a[0]`或者`*a==a[0]`  
此时的`a`是`int`的一维数组，当`a`是`int`的二维数组时，`a`就变成了一个`int **a`，也就是指向指针的指针。  
而字符串数组比较特殊。